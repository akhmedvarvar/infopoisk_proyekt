# Movie Search Engine

## Описание проекта

Этот проект представляет собой поисковую систему для фильмов, которая позволяет искать фильмы по текстовым запросам, а также получать топ фильмов на основе различных критериев сортировки. Он использует FastAPI для создания API, Streamlit для веб-интерфейса, PostgreSQL для хранения данных и различные модели для обработки текста и поиска.

## Структура проекта

- **api/**: 
  - `endpoints.py`: Реализует API-эндпоинты для взаимодействия с клиентами.
  - `main.py`: Создает и настраивает приложение FastAPI.
  - `models.py`: Определяет модели данных с использованием Pydantic.

- **data/**: 
  - Содержит файлы для работы с моделями, такие как TF-IDF векторизатор и эмбеддинги.

- **database/**: 
  - `db_connection.py`: Класс для подключения и выполнения запросов к базе данных PostgreSQL.
  - `db_indexes.py`: Скрипт для создания индексов в таблице фильмов.
  - `db_load.py`: Загружает данные фильмов в базу данных.
  - `db_operations.py`: Методы для операций с данными фильмов.
  - `db_table.py`: Создает таблицу `movies` в базе данных из SQL-схемы.

- **docker/**:
  - Содержит конфигурации для развертывания приложения в контейнерах Docker.

- **models/**:
  - `embedding_model.py`: Модель для создания эмбеддингов текстов.
  - `tfidf_vectorizer.py`: Модель для преобразования текстов в TF-IDF вектора.

- **preprocessing/**:
  - `preprocessing.py`: Функции для предобработки текстов и вычисления эмбеддингов и TF-IDF матриц.

- **search/**:
  - `search_engine.py`: Класс для выполнения поисковых запросов по фильмам.

- **web/**:
  - `app.py`: Приложение Streamlit для поиска и отображения фильмов.

- `docker-compose.yml`: Конфигурация для запуска всех сервисов в Docker.
- `requirements.txt`: Зависимости Python для установки.

## Установка и запуск

### Требования

Для запуска проекта необходимо установить Docker и Docker Compose. Также требуется PostgreSQL для работы с базой данных.

### Установка

1. **Перейдите в репозиторий:**
   ```bash
   cd project
   ```

2. **Запустите сервисы с помощью Docker Compose:**
    ```bash
    docker-compose up --build

3. **Обработка текста и подготовка базы данных:**
    После сборки контейнеров выполните следующие шаги:
    - Запустите скрипт для предобработки текста:
    ```python
    python preprocessing/preprocessing.py
    ```
    - Переместите данные, полученные после предобработки, в папку `data`:
    ```bash
    mv preprocessing/ data/
    ```
    - Создайте таблицу в базе данных:
    ```python
   python database/db_table.py
    ```
    - Загрузите данные в базу данных:
    ```python
    python database/db_load.py
    ```
4. **Зайдите в браузер и откройте приложение:**
    Откройте http://localhost:8501 для доступа к веб-интерфейсу Streamlit.

### Использование
 - Введите текстовый запрос в поле поиска для выполнения поиска фильмов.
 - Выберите метод поиска: tfidf или embedding.
 - Установите количество результатов, которые вы хотите получить.
 - Используйте раздел для получения рекомендаций, чтобы просмотреть топ фильмов.

### Схема базы данных
База данных состоит из одной основной таблицы movies, которая хранит информацию о фильмах:

 - id: уникальный идентификатор фильма.
 - title: название фильма.
 - overview: описание фильма.
 - popularity: популярность фильма.
 - vote_count: количество голосов.
 - vote_average: средний рейтинг.
 - original_language: язык оригинала.
 - genre: жанр фильма.
 - poster_url: URL постера фильма.
 - embedding: эмбеддинг текста.
 - tfidf_vector: TF-IDF вектор текста.

### Параметры запуска
Параметры запуска

- API сервер: Запускается на порту 8000. Можно кидать запросы на ручки из endpoints.py
- Streamlit приложение: Запускается на порту 8501.
- База данных PostgreSQL: Настроена в docker-compose.yml.